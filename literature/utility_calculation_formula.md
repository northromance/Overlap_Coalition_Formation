
# 完整的效用计算公式

## 1. 任务完成度 \( D_C \) 计算

任务的完成度 \( D_C \) 计算基于任务对每种资源的需求与实际分配的资源量之间的比例：

\[
D_C = rac{1}{Z_c} \sum_{j=1}^{Z_c} rac{\sum_{i \in C} A_j^{(i)}}{R_j^{(m)}}
\]

其中：
- \( Z_c \) 是任务 \( m \) 所需的资源类型数量。
- \( \sum_{i \in C} A_j^{(i)} \) 是联盟 \( C \) 中所有机器人对资源类型 \( j \) 的分配总量。
- \( R_j^{(m)} \) 是任务 \( m \) 对资源类型 \( j \) 的需求量。

## 2. 资源贡献比例 \( r_n(C) \) 计算

机器人 \( n \) 对任务的资源贡献比例 \( r_n(C) \) 计算为：

\[
r_n(C) = rac{|A_m^{(n)}|}{\sum_{i \in C} |A_m^{(i)}|}
\]

其中：
- \( |A_m^{(n)}| \) 是机器人 \( n \) 对任务 \( m \) 的资源分配量。
- \( \sum_{i \in C} |A_m^{(i)}| \) 是联盟 \( C \) 中所有机器人对任务 \( m \) 的资源总和。

## 3. 飞行时间 \( t_m^{(wait)} \) 计算

飞行时间 \( t_m^{(wait)} \) 是根据机器人的任务序列来计算的。假设机器人 \( n \) 参与了 \( J \) 个任务，任务 \( m \) 的飞行时间是所有任务的飞行时间之和。飞行时间不包括悬停时间。

\[
t_m^{(wait)} = \sum_{j=1}^{J} t_{task_m^{(j-1)}, task_m^{(j)}}^{(fly)}
\]

其中：
- \( t_{task_m^{(j-1)}, task_m^{(j)}}^{(fly)} \) 是任务从阶段 \( j-1 \) 到阶段 \( j \) 的飞行时间。

## 4. 执行时间 \( T_{	ext{exec}}(n, m) \) 计算

执行时间 \( T_{	ext{exec}}(n, m) \) 是基于机器人任务序列中所有任务的执行时间之和。对于任务 \( m \)，执行时间是机器人 \( n \) 在该任务以及之前任务的执行时间的总和：

\[
T_{	ext{exec}}(n, m) = \sum_{i=1}^{m} T_{	ext{exec}}(n, i)
\]

其中：
- \( T_{	ext{exec}}(n, i) \) 是机器人 \( n \) 执行任务 \( i \) 的时间。

## 5. 总效用公式

机器人 \( n \) 在联盟结构 \( SC_Q \) 中的总效用 \( 	ext{utility}_n(SC_Q) \) 可以表示为：

\[
	ext{utility}_n(SC_Q) = \sum_{C \in SC_Q(n)} \left[ rac{|A_m^{(n)}|}{\sum_{i \in C} |A_m^{(i)}|} 	imes V_C 	imes D_C - \left( t_m^{(wait)} 	imes lpha + \sum_{i=1}^{m} T_{	ext{exec}}(n, i) 	imes eta ight) ight]
\]

其中：
- \( t_m^{(wait)} \) 是任务 \( m \) 的飞行时间，已根据任务序列计算。
- \( lpha \) 是每小时飞行消耗的燃油量。
- \( T_{	ext{exec}}(n, i) \) 是机器人 \( n \) 执行任务 \( i \) 的时间，所有任务的执行时间之和。
- \( eta \) 是每小时执行任务所消耗的能量。

## 6. 计算示例

假设以下数据：

- **飞行时间**：\( t_m^{(wait)} = 20 \) 小时
- **飞行燃油消耗**：\( lpha = 1.5 \) 单位燃油
- **执行时间**：
  - 任务 1 的执行时间：\( T_{	ext{exec}}(n, 1) = 3 \) 小时
  - 任务 2 的执行时间：\( T_{	ext{exec}}(n, 2) = 5 \) 小时
- **每小时执行任务的能耗**：\( eta = 2 \) 单位能量
- **资源贡献比例**：\( r_n(C) = 0.25 \)
- **任务完成度**：\( D_C = 0.75 \)
- **联盟总价值**：\( V_C = 80 \)

#### 计算步骤：

1. **飞行时间的燃油消耗**：
   \[
   	ext{fuel\_cost} = t_m^{(wait)} 	imes lpha = 20 	imes 1.5 = 30 	ext{ 单位燃油}
   \]

2. **执行时间的能耗**：
   - 任务 1 和任务 2 的总执行时间：
     \[
     	ext{total\_exec\_time} = T_{	ext{exec}}(n, 1) + T_{	ext{exec}}(n, 2) = 3 + 5 = 8 	ext{ 小时}
     \]
   - 能耗：
     \[
     	ext{energy\_cost} = 	ext{total\_exec\_time} 	imes eta = 8 	imes 2 = 16 	ext{ 单位能量}
     \]

3. **效用计算**：
   \[
   	ext{utility}_n(C) = 0.25 	imes 80 	imes 0.75 - (30 + 16)
   \]
   \[
   	ext{utility}_n(C) = 15 - 46 = -31
   \]

### 总结

这个公式结合了所有任务的 **执行时间**、**飞行时间**、**资源贡献比例**、**任务完成度** 和 **能耗成本**，提供了机器人在执行多个任务时的总效用计算。每个任务的 **执行时间** 不仅包括当前任务的时间，还包括了之前所有任务的执行时间。通过这种方式，计算出的效用更加准确地反映了机器人的综合表现。
